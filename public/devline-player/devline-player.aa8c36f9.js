/*! For license information please see devline-player.aa8c36f9.js.LICENSE.txt */
"use strict";!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DevLinePlayer",[],t):"object"==typeof exports?exports.DevLinePlayer=t():e.DevLinePlayer=t()}(this,(()=>(this.webpackChunkDevLinePlayer=this.webpackChunkDevLinePlayer||[]).push([[172],{9428:(e,t,r)=>{r.d(t,{default:()=>er});var n=r(6540),o=r(5338),i=function(e){return e.Record="record",e.Live="live",e}({}),a=function(e){return e.Http="http",e.Https="https",e}({}),c=r(6133),u=r(8342),l=r(5681),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'";return(0,c.GP)(e,t)},f=function(e,t){return(0,u.z)(e,t)},d=function(e,t){return(0,l.p)(e,t)},h=function(){return window.location.protocol.includes("https")?a.Https:a.Http},v=function(e){try{if("undefined"!=typeof TextEncoder){var t=(new TextEncoder).encode(e),r=Array.from(t,(function(e){return String.fromCharCode(e)})).join("");return btoa(r)}return btoa(encodeURIComponent(e))}catch(t){var n=e.replace(/[^\x00-\x7F]/g,"");return btoa(n)}};function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function p(){p=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new _(n||[]);return o(a,"_invoke",{value:O(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",h="suspendedYield",v="executing",y="completed",g={};function b(){}function w(){}function x(){}var T={};l(T,a,(function(){return this}));var E=Object.getPrototypeOf,j=E&&E(E(R([])));j&&j!==r&&n.call(j,a)&&(T=j);var S=x.prototype=b.prototype=Object.create(T);function L(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==m(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function O(t,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var l=f(t,r,n);if("normal"===l.type){if(o=n.done?y:h,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=y,n.method="throw",n.arg=l.arg)}}}function P(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(m(t)+" is not iterable")}return w.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},L(k.prototype),l(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new k(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},L(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;M(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function y(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e,t,r){return(t=function(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var T=function(e){var t,r=e.url,n=e.port,o=e.credentials,i=e.startTime,a=e.endTime,c=e.unitLength,u=e.channel,l=e.stream,s=null!==(t=e.protocol)&&void 0!==t?t:h(),f=w(w({start_time:[i.getFullYear(),i.getMonth()+1,i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds()],end_time:[a.getFullYear(),a.getMonth()+1,a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds()],unit_len:c},void 0!==u&&{channel:u}),void 0!==l&&{stream:l});return new Promise((function(e,t){var i=r.startsWith("http")?r:"".concat(s,"://").concat(r),a="".concat(i,":").concat(n,"/rpc?authorization=Basic ").concat(v(o),"&content-type=application/json"),c=new XMLHttpRequest;c.open("POST",a,!0),c.onload=function(){if(c.status>=200&&c.status<300)try{var r=JSON.parse(c.responseText);if(r.error&&"auth"===r.error.type&&"forbidden"===r.error.message)return void t(new Error("FORBIDDEN"));e(r.result)}catch(e){t(new Error("Failed to parse timeline data"))}else t(new Error("Failed to fetch timeline data"))},c.onerror=function(){t(new Error("Failed to fetch timeline data"))},c.send(JSON.stringify({method:"archive.get_frames_timeline",params:f,version:13}))}))},E=function(e,t,r,n){return new Promise((function(o,i){var a=e.startsWith("http")?e:"".concat(null!=n?n:h(),"://").concat(e),c="".concat(a,":").concat(t,"/rpc?authorization=Basic ").concat(v(r),"&content-type=application/json"),u=new XMLHttpRequest;u.open("POST",c,!0),u.onload=function(){if(u.status>=200&&u.status<300)try{var e=JSON.parse(u.responseText).result.info.local_time;if(Array.isArray(e)&&e.length>=7){var t=(v=7,function(e){if(Array.isArray(e))return e}(h=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(h,v)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}(h,v)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=t[0],n=t[1],a=t[2],c=t[3],l=t[4],s=t[5],f=t[6],d=new Date(r,n-1,a,c,l,s,f);o(d)}else i(new Error("Invalid server time format"))}catch(e){i(new Error("Failed to parse server time response"))}else i(new Error("Failed to fetch server time"));var h,v},u.onerror=function(){i(new Error("Failed to fetch server time"))},u.send(JSON.stringify({method:"get_server_info",version:12}))}))},j=function(e,t,r,n,o){return new Promise((function(i,a){var c=e.startsWith("http")?e:"".concat(null!=o?o:h(),"://").concat(e),u="".concat(c,":").concat(t,"/rpc?authorization=Basic ").concat(v(r),"&content-type=application/json"),l=new XMLHttpRequest;l.open("POST",u,!0),l.onload=function(){if(l.status>=200&&l.status<300)try{var e=JSON.parse(l.responseText);i(e)}catch(e){a(new Error("Failed to parse server time response"))}else a(new Error("Failed to fetch server time"))},l.onerror=function(){a(new Error("Failed to fetch server time"))},l.send(JSON.stringify({method:"get_camera_state",params:{camera:String(n)},version:13}))}))},S=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3,o=arguments.length>4?arguments[4]:void 0;return new Promise(function(){var i,a=(i=p().mark((function i(a,c){var u,l,s,f,d,m,y,g,b,w;return p().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,u=new AbortController,l=setTimeout((function(){return u.abort()}),n),s=e.startsWith("http")?e:"".concat(null!=o?o:h(),"://").concat(e),f="".concat(s,":").concat(t,"/cameras?authorization=Basic%20").concat(v(r)),i.next=7,fetch(f,{method:"GET",signal:u.signal});case 7:if(d=i.sent,clearTimeout(l),401!==d.status){i.next=12;break}return c(new Error("FORBIDDEN")),i.abrupt("return");case 12:if(d.ok){i.next=15;break}return c(new Error("Failed to fetch cameras: ".concat(d.status))),i.abrupt("return");case 15:return i.next=17,d.text();case 17:if(m=i.sent,y=new DOMParser,!(g=y.parseFromString(m,"application/xml")).getElementsByTagName("parsererror")[0]){i.next=24;break}return c(new Error("Failed to parse cameras XML")),i.abrupt("return");case 24:b=Array.from(g.getElementsByTagName("camera")),w=b.map((function(e){var t,r,n,o,i,a,c,u=function(t){var r,n;return null!==(r=null===(n=e.getElementsByTagName(t)[0])||void 0===n?void 0:n.textContent)&&void 0!==r?r:void 0},l=null!==(t=u("uri"))&&void 0!==t?t:"",s=null!==(r=l.split("/").filter(Boolean).pop())&&void 0!==r?r:"0",f=Number.parseInt(s,10),d=Number.parseInt(null!==(n=u("width"))&&void 0!==n?n:"",10),h=Number.parseInt(null!==(o=u("height"))&&void 0!==o?o:"",10);return{id:Number.isNaN(f)?0:f,uri:l,name:null!==(i=u("name"))&&void 0!==i?i:void 0,width:Number.isNaN(d)?void 0:d,height:Number.isNaN(h)?void 0:h,imageUri:null!==(a=u("image-uri"))&&void 0!==a?a:void 0,streamingUri:null!==(c=u("streaming-uri"))&&void 0!==c?c:void 0}})),a(w),i.next=35;break;case 29:if(i.prev=29,i.t0=i.catch(0),"AbortError"!==i.t0.name){i.next=34;break}return c(new Error("Failed to fetch cameras: timeout")),i.abrupt("return");case 34:c(new Error("Failed to fetch cameras"));case 35:case"end":return i.stop()}}),i,null,[[0,29]])})),function(){var e=this,t=arguments;return new Promise((function(r,n){var o=i.apply(e,t);function a(e){y(o,r,n,a,c,"next",e)}function c(e){y(o,r,n,a,c,"throw",e)}a(void 0)}))});return function(e,t){return a.apply(this,arguments)}}())},L=[3e5,6e5,9e5,18e5,36e5,144e5,216e5,432e5,864e5],k=[5,10,15,30,60,240,360,720,1440],O=function(e){return 0===e.getHours()&&0===e.getMinutes()},P=function(e){return 0===e.getMinutes()},C=function(e,t){var r;return e.getHours()%(null!==(r={1:1,4:1,6:1,12:3,24:3}[t/36e5])&&void 0!==r?r:1)==0},M=function(e){return e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})},_=function(e){return e.getMinutes()%5==0},R=function(e){return 0===e.getSeconds()};var N=r(4848),A=function(e){var t=e.visibleTimeRange,r=e.setVisibleTimeRange,o=e.intervalIndex,i=e.fragments,a=e.fragmentsBufferRange,c=e.loadFragments,u=e.currentTime,l=e.progress,s=e.onMouseDown,f=e.onMouseUp,d=e.onMouseMove,h=e.onMouseLeave,v=e.onClick,m=e.containerRef,p=e.canvasRef;return function(e){var t=e.canvasRef,r=e.containerRef,o=e.visibleTimeRange,i=(e.setVisibleTimeRange,e.intervalIndex),a=e.fragments,c=e.fragmentsBufferRange,u=e.loadFragments,l=e.currentTime,s=e.progress,f=e.cursorPosition,d=(0,n.useRef)(new Date(l)),h=(0,n.useRef)(s),v=(0,n.useRef)(null),m=(0,n.useRef)(null),p=(0,n.useCallback)((function(e){var n=t.current,u=r.current,d=null==n?void 0:n.getContext("2d");if(n&&d&&u){var h=u.getBoundingClientRect();n.style.width="".concat(h.width,"px"),n.style.height="".concat(h.height,"px");var v=window.devicePixelRatio||1;n.width=h.width*v,n.height=h.height*v,d.scale(v,v),d.clearRect(0,0,h.width,h.height),function(e,t,r){e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(0,0,t,r)}(d,h.width,h.height);var m=h.width/(o.end.getTime()-o.start.getTime()),p=void 0!==e?e:s;!function(e,t,r,n,o){var i=new Date(t.start);for(i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),e.beginPath(),e.moveTo(0,6),e.lineTo(r,6),e.strokeStyle="rgba(255, 255, 255, 0.3)",e.lineWidth=4,e.stroke();i<=t.end;){var a=(i.getTime()-t.start.getTime())*o;if(a>=0&&a<=r)if(O(i))e.beginPath(),e.moveTo(a,6),e.lineTo(a,16),e.strokeStyle="rgba(255, 255, 255, 0.6)",e.lineWidth=1,e.stroke(),e.fillStyle="#4CAF50",e.font="bold 12px Arial",e.textAlign="center",e.textBaseline="top",e.fillText(i.toLocaleDateString([],{day:"2-digit",month:"2-digit"}),a,20);else if(P(i)){e.beginPath(),e.moveTo(a,6),e.lineTo(a,14),e.strokeStyle="rgba(255, 255, 255, 0.4)",e.lineWidth=1,e.stroke();var c=t.end.getTime()-t.start.getTime();C(i,c)&&(e.fillStyle="#ffffff",e.font="12px Arial",e.textAlign="center",e.textBaseline="top",e.fillText(M(i),a,20))}i=new Date(i.getTime()+36e5)}}(d,o,h.width,h.height,m),function(e,t,r,n,o,i){e.fillStyle="#ffffff",e.font="12px Arial",e.textAlign="center",e.textBaseline="top";var a=t.end.getTime()-t.start.getTime(),c=Math.floor(r/50),u=i;i>=144e5?u=36e5:i>=36e5?u=18e5:i>=18e5?u=6e5:i>=9e5?u=3e5:i>=3e5&&(u=6e4);var l=Math.ceil(a/u);if(l>c){var s=Math.ceil(l/c);6e4===u?u=3e5:3e5===u?u=6e5:6e5===u?u=18e5:18e5===u?u=36e5:36e5===u?u=108e5:u*=s}var f=new Date(t.start);if(36e5===u)f.setMinutes(0),f.setSeconds(0),f.setMilliseconds(0);else if(18e5===u){var d=f.getMinutes();f.setMinutes(d-d%30),f.setSeconds(0),f.setMilliseconds(0)}else if(6e5===u){var h=f.getMinutes();f.setMinutes(h-h%10),f.setSeconds(0),f.setMilliseconds(0)}else if(3e5===u){var v=f.getMinutes();f.setMinutes(v-v%5),f.setSeconds(0),f.setMilliseconds(0)}else if(6e4===u)f.setSeconds(0),f.setMilliseconds(0);else{var m=f.getTime()%u;f=new Date(f.getTime()-m+(m>u/2?u:0))}for(;f<t.end;){var p=(f.getTime()-t.start.getTime())*o;p>=0&&p<=r&&(O(f)||P(f)||(f.getMinutes()%30==0?(e.beginPath(),e.moveTo(p,n-4),e.lineTo(p,n),e.strokeStyle="rgba(255, 255, 255, 0.3)",e.lineWidth=1,e.stroke(),e.fillText(M(f),p,20)):f.getMinutes()%15==0?(e.beginPath(),e.moveTo(p,n-3),e.lineTo(p,n),e.strokeStyle="rgba(255, 255, 255, 0.2)",e.lineWidth=1,e.stroke(),e.fillText(M(f),p,20)):_(f)?(e.beginPath(),e.moveTo(p,n-2),e.lineTo(p,n),e.strokeStyle="rgba(255, 255, 255, 0.2)",e.lineWidth=1,e.stroke(),i<=6e5&&e.fillText(M(f),p,20)):R(f)&&(e.beginPath(),e.moveTo(p,n-2),e.lineTo(p,n),e.strokeStyle="rgba(255, 255, 255, 0.1)",e.lineWidth=.5,e.stroke(),i<=3e5&&e.fillText(M(f),p,20)))),f=new Date(f.getTime()+u)}}(d,o,h.width,h.height,m,L[i]),function(e,t,r,n,o,i,a,c){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=r.end.getTime()-r.start.getTime(),s=0,f=0;if(e.fillStyle="rgba(128, 128, 128, 0.3)",e.fillRect(0,4,o,4),0!==t.length&&(e.fillStyle="#4CAF50",t.forEach((function(t,i){if(t){var c=n.start.getTime()+i*a,u=c+a,d=(c-r.start.getTime())/l*o,h=(u-r.start.getTime())/l*o;if(h>=0&&d<=o){var v=Math.max(0,d),m=Math.min(o,h)-v;e.fillRect(v,4,m,4),u>s&&(s=u,f=h)}}})),c&&s>0)){var d=c.getTime()+1e3*u,h=(d-r.start.getTime())/l*o;if(h>f&&h<=o&&h>=0&&d>s){var v=Math.max(0,f),m=Math.min(o,h)-v;e.fillRect(v,4,m,4)}}}(d,a,o,c,h.width,h.height,1e3*k[i],l,p);var y=l.getTime()+1e3*p;y>=o.start.getTime()&&y<=o.end.getTime()&&function(e,t,r,n,o,i){var a=o/(n.end.getTime()-n.start.getTime()),c=(t.getTime()+1e3*r-n.start.getTime())*a;c>=0&&c<=o&&(e.beginPath(),e.moveTo(c,4),e.lineTo(c,i),e.strokeStyle="#00CC66",e.lineWidth=1,e.stroke())}(d,l,p,o,h.width,h.height),f&&function(e,t,r){if(t&&t.time){e.beginPath(),e.moveTo(t.x,4),e.lineTo(t.x,r),e.strokeStyle="#FFFFFF",e.lineWidth=1,e.setLineDash([5,3]),e.stroke(),e.setLineDash([]);var n=t.time.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),o=t.time.toLocaleDateString([],{day:"2-digit",month:"2-digit",year:"numeric"}),i="".concat(o," ").concat(n);e.fillStyle="rgb(246, 244, 244)",e.font="12px Arial";var a=e.measureText(i).width+10,c=t.x+5;c+a>e.canvas.width&&(c=t.x-a-5),e.fillRect(c,9,a,24),e.strokeStyle="rgb(55, 55, 55)",e.lineWidth=1,e.strokeRect(c,9,a,24),e.fillStyle="rgb(55, 55, 55)",e.textAlign="center",e.textBaseline="middle",e.fillText(i,c+a/2,21)}}(d,f,h.height)}}),[t,r,o,i,a,c,l,s,f]),y=(0,n.useCallback)((function(e){null===m.current&&(m.current=e);var t=e-m.current;m.current=e;var r=t/1e3,n=h.current+r;p(n),v.current=requestAnimationFrame(y)}),[p]);(0,n.useEffect)((function(){return d.current=new Date(l),h.current=s,m.current=null,v.current||(v.current=requestAnimationFrame(y)),function(){v.current&&(cancelAnimationFrame(v.current),v.current=null)}}),[y,l,s]),(0,n.useEffect)((function(){if(r.current){var e=o.end.getTime()-o.start.getTime();o.start.getTime()-c.start.getTime()<e&&u(o.start,o.end,i)}}),[o,r,u,c,i])}({canvasRef:p,containerRef:m,visibleTimeRange:t,setVisibleTimeRange:r,intervalIndex:o,fragments:i,fragmentsBufferRange:a,loadFragments:c,currentTime:u,progress:l,cursorPosition:e.cursorPosition}),(0,N.jsx)("div",{ref:m,className:"timeline--Z2r81",onMouseDown:s,onMouseUp:f,onMouseMove:d,onMouseLeave:h,onClick:v,children:(0,N.jsx)("canvas",{ref:p})})};function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var I=(0,n.createContext)(void 0),B=function(e){var t=e.children,r=D((0,n.useState)(null),2),o=r[0],i=r[1],a=D((0,n.useState)(0),2),c=a[0],u=a[1],l=D((0,n.useState)(!1),2),s=l[0],f=l[1],d=(0,n.useCallback)((function(e,t){i(e),u(0),f(t||!1)}),[]),h=(0,n.useCallback)((function(e){f(!0),u(e)}),[]);return(0,N.jsx)(I.Provider,{value:{skipCenterTimeline:s,serverTime:o,progress:c,setServerTime:d,setProgress:h},children:t})},z=function(){var e=(0,n.useContext)(I);if(!e)throw new Error("useTime must be used within TimeProvider");return e};function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function H(){H=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),c=new C(n||[]);return o(a,"_invoke",{value:L(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",h="suspendedYield",v="executing",m="completed",p={};function y(){}function g(){}function b(){}var w={};l(w,a,(function(){return this}));var x=Object.getPrototypeOf,T=x&&x(x(M([])));T&&T!==r&&n.call(T,a)&&(w=T);var E=b.prototype=y.prototype=Object.create(w);function j(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==G(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=k(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var l=f(t,r,n);if("normal"===l.type){if(o=n.done?m:h,l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function k(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function M(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(G(t)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},j(S.prototype),l(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new S(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},j(E),l(E,u,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=M,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:M(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function U(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?W(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=z(),c=a.serverTime,u=a.setServerTime,l=a.progress,s=a.skipCenterTimeline,f=V((0,n.useState)(!0),2),d=f[0],h=f[1],v=V((0,n.useState)(0),2),m=v[0],p=v[1],y=V((0,n.useState)(null),2),g=y[0],b=y[1],w=(0,n.useCallback)((function(e){b((function(t){return n=e,!(r=t)&&!n||r&&n&&r.start.getTime()===n.start.getTime()&&r.end.getTime()===n.end.getTime()?(console.log("setVisibleTimeRangeState: диапазон не изменился, пропускаем обновление"),t):(console.log("setVisibleTimeRangeState: обновляем диапазон",e),e);var r,n}))}),[]),x=V((0,n.useState)(null),2),T=x[0],j=x[1];(0,n.useEffect)((function(){if(c&&!g){var e=L[m]/2,t=new Date(c.getTime()+1e3*l),r=new Date(t.getTime()-e),n=new Date(t.getTime()+e);w({start:r,end:n}),h(!1)}}),[c,g,m,l]),(0,n.useEffect)((function(){t&&r&&o&&!c&&(h(!0),E(t,r,o,i).then((function(e){u(e);var t=L[m]/2,r=new Date(e.getTime()+1e3*l),n=new Date(r.getTime()-t),o=new Date(r.getTime()+t);w({start:n,end:o}),h(!1)})).catch((function(e){console.error("Ошибка при получении времени сервера:",e),h(!1)})))}),[t,r,o,m]);var S=function(){var e,n=(e=H().mark((function e(){var n;return H().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r&&o){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,E(t,r,o,i);case 4:return n=e.sent,u(n),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){U(i,n,o,a,c,"next",e)}function c(e){U(i,n,o,a,c,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}(),k=(0,n.useCallback)((function(e){w(e)}),[]),O=(0,n.useCallback)((function(){if(c){var t=new Date(c.getTime()+1e3*e),r=L[m]/2,n=new Date(t.getTime()-r),o=new Date(t.getTime()+r);w({start:n,end:o})}}),[c,l,m]),P=(0,n.useRef)(null);(0,n.useEffect)((function(){if(c&&g&&!s){var e=P.current,t=c;(!e||Math.abs(t.getTime()-e.getTime())>1e3)&&(console.log("Центрируем таймлайн: серверное время изменилось значительно"),O())}P.current=c}),[c,O,g,s]);var C=(0,n.useCallback)((function(e,t){if(g){var r=e/t*(g.end.getTime()-g.start.getTime()),n=new Date(g.start.getTime()+r);j({x:e,time:n})}}),[g]),M=(0,n.useCallback)((function(){j(null)}),[]);return{serverTime:c,isLoading:d,intervalIndex:m,setIntervalIndex:p,visibleTimeRange:g,setVisibleTimeRange:k,centerOnCurrentTime:O,cursorPosition:T,updateCursorPosition:C,resetCursorPosition:M,updateServerTime:S}};function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var q=(0,n.createContext)(void 0),J=function(e){var t,r,o=e.children,i=(t=(0,n.useState)(!0),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,r)||function(e,t){if(e){if("string"==typeof e)return X(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?X(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],c=i[1];return(0,N.jsx)(q.Provider,{value:{hasTimelineAccess:a,setTimelineAccess:function(e){c(e)}},children:o})},$=function(){var e=(0,n.useContext)(q);if(void 0===e)throw new Error("useTimelineAuth must be used within a TimelineAuthProvider");return e};function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Q(){Q=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),c=new C(n||[]);return o(a,"_invoke",{value:L(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",h="suspendedYield",v="executing",m="completed",p={};function y(){}function g(){}function b(){}var w={};l(w,a,(function(){return this}));var x=Object.getPrototypeOf,T=x&&x(x(M([])));T&&T!==r&&n.call(T,a)&&(w=T);var E=b.prototype=y.prototype=Object.create(w);function j(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==K(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=k(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var l=f(t,r,n);if("normal"===l.type){if(o=n.done?m:h,l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function k(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function M(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(K(t)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},j(S.prototype),l(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new S(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},j(E),l(E,u,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=M,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:M(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function Z(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function ee(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Z(i,n,o,a,c,"next",e)}function c(e){Z(i,n,o,a,c,"throw",e)}a(void 0)}))}}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return re(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?re(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return oe(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?oe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ie=n.forwardRef((function(e,t){var r=e.url,o=e.port,a=e.credentials,c=e.onTimeClick,u=e.progress,l=void 0===u?0:u,s=e.camera,f=e.mode,d=e.protocol,h=(0,n.useRef)(null),v=(0,n.useRef)(null),m=Y(l,r,o,a,d),p=m.serverTime,y=m.isLoading,g=m.visibleTimeRange,b=m.setVisibleTimeRange,w=m.intervalIndex,x=m.setIntervalIndex,E=m.centerOnCurrentTime,j=m.cursorPosition,S=m.updateCursorPosition,O=m.resetCursorPosition,P=function(e){var t=e.url,r=e.port,o=e.credentials,i=e.camera,a=e.protocol,c=$().setTimelineAccess,u=te((0,n.useState)([]),2),l=u[0],s=u[1],f=te((0,n.useState)((function(){return{start:new Date(0),end:new Date(0)}})),2),d=f[0],h=f[1],v=te((0,n.useState)(!1),2),m=v[0],p=v[1],y=(0,n.useRef)(null),g=(0,n.useCallback)(ee(Q().mark((function e(){var n,u,l,f,d,v,b,w;return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m&&y.current){e.next=2;break}return e.abrupt("return");case 2:return n=y.current,u=n.start,l=n.end,f=n.zoomIndex,y.current=null,p(!0),e.prev=5,d=l.getTime()-u.getTime(),v=new Date(u.getTime()-2*d),b=new Date(l.getTime()+2*d),e.next=11,T({startTime:v,url:t,port:r,credentials:o,endTime:b,unitLength:k[f],stream:"video",channel:i,protocol:a});case 11:w=e.sent,y.current||(s(w.timeline),h({start:v,end:b})),e.next=21;break;case 15:if(e.prev=15,e.t0=e.catch(5),console.error("Failed to load fragments:",e.t0),!(e.t0 instanceof Error&&"FORBIDDEN"===e.t0.message)){e.next=21;break}return c(!1),e.abrupt("return");case 21:return e.prev=21,p(!1),y.current&&g(),e.finish(21);case 25:case"end":return e.stop()}}),e,null,[[5,15,21,25]])}))),[m,t,r,o,i]),b=(0,n.useCallback)((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(y.current&&y.current.start.getTime()===e.getTime()&&y.current.end.getTime()===t.getTime()&&y.current.zoomIndex===r)console.log("loadFragments: запрос уже в очереди, пропускаем");else{var n=t.getTime()-e.getTime(),o=new Date(e.getTime()-2*n),i=new Date(t.getTime()+2*n),a=d.start.getTime(),c=d.end.getTime();a<=o.getTime()&&c>=i.getTime()&&0!==a&&!m?console.log("loadFragments: диапазон уже загружен, пропускаем"):(console.log("loadFragments: добавляем новый запрос в очередь"),y.current={start:e,end:t,zoomIndex:r},g())}}),[g,d,m]),w=(0,n.useCallback)((function(){s([]),h({start:new Date(0),end:new Date(0)})}),[]);return{fragments:l,fragmentsBufferRange:d,isLoadingFragments:m,loadFragments:b,resetFragments:w}}({url:r,port:o,credentials:a,camera:s,protocol:d}),C=P.fragments,M=P.fragmentsBufferRange,_=P.loadFragments,R=P.resetFragments,D=function(e){var t=e.canvasRef,r=e.containerRef,o=e.visibleTimeRange,i=e.setVisibleTimeRange,a=e.intervalIndex,c=e.setIntervalIndex,u=e.fragments,l=e.fragmentsBufferRange,s=e.loadFragments,f=e.resetFragments,d=e.currentTime,h=e.onTimeClick,v=(e.progress,ne((0,n.useState)(!1),2)),m=v[0],p=v[1],y=ne((0,n.useState)(!1),2),g=y[0],b=y[1],w=ne((0,n.useState)(0),2),x=w[0],T=w[1],E=ne((0,n.useState)(0),2),j=E[0],S=E[1],O=(0,n.useCallback)((function(e){p(!0),b(!1),T(e.pageX-r.current.offsetLeft)}),[r]),P=(0,n.useCallback)((function(){p(!1)}),[]),C=(0,n.useCallback)((function(e){if(m&&r.current){var t=(e.clientX-x)/(r.current.getBoundingClientRect().width/(o.end.getTime()-o.start.getTime())),n=new Date(o.start.getTime()-t),c=new Date(o.end.getTime()-t),u=c.getTime()-n.getTime(),f=n.getTime()-l.start.getTime(),d=l.end.getTime()-c.getTime();(f<u||d<u)&&s(n,c,a),T(e.clientX),i({start:n,end:c}),b(!0)}}),[m,x,r,o,l,s,i,a]),M=(0,n.useCallback)((function(e){if(e.preventDefault(),e.shiftKey){var r=e.deltaY,n=o.end.getTime()-o.start.getTime(),u=r/t.current.width*n,d=new Date(o.start.getTime()+u),h=new Date(o.end.getTime()+u),v=h.getTime()-d.getTime(),m=d.getTime()-l.start.getTime(),p=l.end.getTime()-h.getTime();(m<v||p<v)&&s(d,h,a),i({start:d,end:h})}else{var y=j+Math.abs(e.deltaY);if(S(y),y>=50){S(0);var g=e.deltaY<0,b=Math.min(Math.max(a+(g?-1:1),0),L.length-1);if(b!==a){var w=t.current.getBoundingClientRect(),x=e.clientX-w.left,T=o.end.getTime()-o.start.getTime(),E=x/w.width*T,k=new Date(o.start.getTime()+E),O=(o.end.getTime()-o.start.getTime())*(L[b]/L[a]),P=x/w.width,C=new Date(k.getTime()-P*O),M=new Date(C.getTime()+O);f(),c(b),s(C,M,b),i({start:C,end:M})}}}}),[o,a,d,j,t,l,s,f,c,i]),_=(0,n.useCallback)((function(){var e=t.current;return e?(e.addEventListener("wheel",M,{passive:!1}),function(){e.removeEventListener("wheel",M)}):function(){}}),[t,M]),R=(0,n.useCallback)((function(e){if(!g&&h&&t.current){var r=t.current.getBoundingClientRect(),n=(e.clientX-r.left)/r.width*(o.end.getTime()-o.start.getTime()),i=new Date(o.start.getTime()+n),c=function(e,t,r,n,o){if(0===t.length)return null;if(e.getTime()>o.getTime())return null;var i=1e3*n,a=r.start.getTime(),c=r.end.getTime(),u=e.getTime();if(u<a||u>c)return null;var l=Math.floor((u-a)/i);if(l<0||l>=t.length)return null;if(t[l]>0)return e;for(var s=l+1;s<t.length;s++)if(t[s]>0)return new Date(a+s*i);return null}(i,u,l,k[a],d);h(c||i)}}),[g,h,o,t,u,l,a,d]);return{handleMouseDown:O,handleMouseUp:P,handleMouseMove:C,handleClick:R,setupWheelHandler:_}}({canvasRef:v,containerRef:h,visibleTimeRange:g||{start:new Date,end:new Date},setVisibleTimeRange:b,intervalIndex:w,setIntervalIndex:x,fragments:C,fragmentsBufferRange:M,loadFragments:_,resetFragments:R,currentTime:p||new Date,onTimeClick:c,progress:l}),F=D.handleMouseDown,I=D.handleMouseUp,B=D.handleMouseMove,z=D.handleClick,G=D.setupWheelHandler,H=(0,n.useCallback)((function(e){if(B(e),h.current){var t=h.current.getBoundingClientRect(),r=e.clientX-t.left;S(r,t.width)}}),[B,h,S]),U=(0,n.useCallback)((function(){I(),O()}),[I,O]);(0,n.useEffect)((function(){t&&(t.current={setVisibleTimeRange:function(e,t){return b({start:e,end:t})},centerOnCurrentTime:E,getCurrentTime:function(){return p}})}),[t,b,E,p]),(0,n.useEffect)((function(){return G()}),[G]);var V=(0,n.useMemo)((function(){return!g||y?null:{startTime:g.start.getTime(),endTime:g.end.getTime(),intervalIndex:w}}),[g,y,w]);(0,n.useEffect)((function(){V&&(console.log("Загружаем фрагменты для диапазона:",new Date(V.startTime),"до",new Date(V.endTime)),_(new Date(V.startTime),new Date(V.endTime),V.intervalIndex))}),[V,_]);var W=(0,n.useRef)(f);return(0,n.useEffect)((function(){W.current!==f&&(f===i.Record&&g&&(R(),_(g.start,g.end,w)),W.current=f)}),[f,g,w,_,R]),p&&g?(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(A,{visibleTimeRange:g||{start:new Date,end:new Date},setVisibleTimeRange:b,intervalIndex:w,fragments:C,fragmentsBufferRange:M,loadFragments:_,currentTime:p||new Date,progress:l,onMouseDown:F,onMouseUp:I,onMouseMove:H,onMouseLeave:U,onClick:z,containerRef:h,canvasRef:v,cursorPosition:j})}):(0,N.jsx)("div",{className:"timeline-loading",children:(0,N.jsx)("span",{children:"Загрузка временной шкалы..."})})}));ie.displayName="Timeline";var ae,ce,ue,le,se,fe,de,he,ve,me,pe,ye,ge,be,we,xe,Te,Ee,je,Se,Le,ke,Oe,Pe=r(9386),Ce=r.n(Pe),Me=r(5614),_e=r(7763),Re=r(6304),Ne=r(6463);function Ae(e,t,r,n){var o=function(t){var o=t.width,i=t.height,a=o||r,c=i||n;return(0,N.jsx)(e,{width:Number.isInteger(a)?"".concat(a,"px"):a,height:Number.isInteger(c)?"".concat(c,"px"):c})};return o.displayName="Icon.".concat(t),o}function De(){return De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},De.apply(null,arguments)}function Fe(){return Fe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fe.apply(null,arguments)}function Ie(){return Ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ie.apply(null,arguments)}function Be(){return Be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Be.apply(null,arguments)}function ze(){return ze=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ze.apply(null,arguments)}function Ge(){return Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ge.apply(null,arguments)}function He(){return He=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},He.apply(null,arguments)}function Ue(){return Ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ue.apply(null,arguments)}function Ve(){return Ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ve.apply(null,arguments)}function We(){return We=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},We.apply(null,arguments)}function Ye(){return Ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ye.apply(null,arguments)}function Xe(){return Xe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xe.apply(null,arguments)}function qe(){return qe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qe.apply(null,arguments)}function Je(){return Je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Je.apply(null,arguments)}function $e(){return $e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$e.apply(null,arguments)}var Ke={Datepicker:Ae((function(e){return n.createElement("svg",De({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 20 20"},e),ae||(ae=n.createElement("path",{fill:"#fff",d:"M17 2h-2V1a1 1 0 0 0-2 0v1H7V1a1 1 0 0 0-2 0v1H3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3V5a3 3 0 0 0-3-3m1 15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-7h16zm0-9H2V5a1 1 0 0 1 1-1h2v1a1 1 0 0 0 2 0V4h6v1a1 1 0 0 0 2 0V4h2a1 1 0 0 1 1 1z"})))}),"Datepicker",20,20),Archive:Ae((function(e){return n.createElement("svg",Fe({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",xmlSpace:"preserve",width:"1em",height:"1em",style:{shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",imageRendering:"optimizeQuality",fillRule:"evenodd",clipRule:"evenodd"},viewBox:"0 0 377.02 369.85"},e),n.createElement("defs",null,n.createElement("linearGradient",{id:"archive_svg__id0",x1:169.84,x2:169.84,y1:196.86,y2:142.83,gradientUnits:"userSpaceOnUse"},n.createElement("stop",{offset:0,style:{stopOpacity:1,stopColor:"#959899"}}),n.createElement("stop",{offset:1,style:{stopOpacity:1,stopColor:"#fefefe"}})),n.createElement("linearGradient",{id:"archive_svg__id1",x1:78.39,x2:261.3,y1:93.07,y2:93.07,gradientUnits:"userSpaceOnUse"},n.createElement("stop",{offset:0,style:{stopOpacity:1,stopColor:"white"}}),n.createElement("stop",{offset:1,style:{stopOpacity:1,stopColor:"#9d9e9e"}})),ce||(ce=n.createElement("linearGradient",{xlinkHref:"#archive_svg__id1",id:"archive_svg__id2",x1:198.7,x2:50.73,y1:285.71,y2:178.2,gradientUnits:"userSpaceOnUse"})),ue||(ue=n.createElement("linearGradient",{xlinkHref:"#archive_svg__id1",id:"archive_svg__id3",x1:214.6,x2:271.12,y1:59.15,y2:233.09,gradientUnits:"userSpaceOnUse"})),le||(le=n.createElement("linearGradient",{xlinkHref:"#archive_svg__id1",id:"archive_svg__id4",x1:68.57,x2:125.09,y1:233.09,y2:59.15,gradientUnits:"userSpaceOnUse"})),se||(se=n.createElement("linearGradient",{xlinkHref:"#archive_svg__id1",id:"archive_svg__id5",x1:288.95,x2:140.99,y1:178.2,y2:285.71,gradientUnits:"userSpaceOnUse"})),fe||(fe=n.createElement("style",null,".archive_svg__str0,.archive_svg__str1{stroke:#000;stroke-width:11.67;stroke-miterlimit:22.9256}.archive_svg__str1{stroke-linejoin:round}.archive_svg__fil0{fill:#1f1e1e}"))),n.createElement("g",{id:"archive_svg__\\u0421\\u043B\\u043E\\u0439_x0020_1"},n.createElement("g",{id:"archive_svg___1046838800"},de||(de=n.createElement("ellipse",{cx:169.84,cy:334.82,className:"archive_svg__fil0",rx:114.17,ry:9.36})),n.createElement("path",{d:"M169.84 5.83c90.58 0 164.01 73.43 164.01 164.01s-73.43 164.01-164.01 164.01S5.83 260.42 5.83 169.84 79.26 5.83 169.84 5.83z",className:"archive_svg__str0",style:{fill:"#ced0d0"}}),n.createElement("path",{d:"M187.64 143.77 261.3 42.38c-107.94 78.97-74.96 78.97-182.9 0l73.66 101.39a30.17 30.17 0 0 1 17.79-5.78c6.65 0 12.8 2.15 17.79 5.78",style:{fill:"url(#archive_svg__id1)"}}),n.createElement("path",{d:"M150.54 144.87 76.88 43.48c41.75 127.06 51.94 95.69-56.52 173.95l119.19-38.73a30.17 30.17 0 0 1-.01-18.7c2.05-6.32 6-11.5 11-15.13",style:{fill:"url(#archive_svg__id4)"}}),n.createElement("path",{d:"M140.13 180.49 20.94 219.22c133.74-.44 107.06-19.83 147.97 107.51l-.01-125.33c-6.17.01-12.4-1.87-17.78-5.78-5.37-3.9-9.09-9.26-10.99-15.13",style:{fill:"url(#archive_svg__id2)"}}),n.createElement("path",{d:"M170.78 201.4v125.32c40.91-127.34 14.22-107.95 147.97-107.5l-119.2-38.73a30.1 30.1 0 0 1-10.99 15.13 30.2 30.2 0 0 1-17.79 5.78z",style:{fill:"url(#archive_svg__id5)"}}),n.createElement("path",{d:"m200.14 178.7 119.19 38.73c-108.46-78.25-98.27-46.88-56.52-173.95l-73.67 101.4c4.99 3.62 8.94 8.8 11 15.12 2.05 6.32 1.9 12.84-.01 18.7z",style:{fill:"url(#archive_svg__id3)"}}),n.createElement("path",{d:"M169.84 142.83c14.92 0 27.01 12.09 27.01 27.01s-12.09 27.01-27.01 27.01-27.01-12.09-27.01-27.01 12.09-27.01 27.01-27.01z",className:"archive_svg__str0",style:{fill:"url(#archive_svg__id0)"}}),n.createElement("path",{d:"M89.4 280.57c-15.06-10.94-18.4-32.01-7.46-47.07s32.01-18.4 47.07-7.46 18.4 32.01 7.46 47.07c-10.94 15.05-32.02 18.4-47.07 7.46zm160.88 0c-15.05 10.94-36.13 7.6-47.07-7.46s-7.6-36.13 7.46-47.07 36.13-7.6 47.07 7.46c10.93 15.06 7.6 36.13-7.46 47.07zM300 127.56c5.75 17.7-3.94 36.71-21.64 42.46s-36.71-3.93-42.46-21.63 3.94-36.71 21.64-42.46 36.71 3.93 42.46 21.63zM169.84 32.99c18.61 0 33.7 15.09 33.7 33.7s-15.09 33.7-33.7 33.7-33.7-15.09-33.7-33.7 15.09-33.7 33.7-33.7zM39.68 127.56c5.75-17.7 24.76-27.39 42.46-21.63 17.7 5.75 27.39 24.76 21.64 42.46s-24.77 27.39-42.46 21.63c-17.7-5.75-27.39-24.76-21.64-42.46z",className:"archive_svg__str1",style:{fill:"#9d9e9e"}}),n.createElement("path",{d:"M169.85 68.54c11.52 0 22.59 1.93 32.9 5.47-3.34 15.09-16.8 26.37-32.9 26.37s-29.56-11.28-32.9-26.37a101.1 101.1 0 0 1 32.9-5.47zm80.96 40.41c12.77 16.95 20.34 38.03 20.34 60.89l-.02 1.67c-15.37 1.47-30.24-7.84-35.22-23.14-4.96-15.3 1.59-31.57 14.89-39.42zm1.97 119.07c-12.81 18.21-31.45 32.01-53.21 38.68-6.16-14.17-1.91-31.21 11.11-40.67s30.52-8.24 42.1 1.99zM140.14 266.7c-21.77-6.67-40.42-20.47-53.21-38.68 11.58-10.23 29.08-11.45 42.1-1.99s17.27 26.5 11.11 40.67zm-71.56-95.19-.02-1.67c0-22.85 7.57-43.94 20.34-60.89 13.3 7.85 19.86 24.12 14.89 39.42s-19.85 24.61-35.22 23.14z",className:"archive_svg__str1",style:{fill:"#25588a"}}),he||(he=n.createElement("ellipse",{cx:303.78,cy:362.93,className:"archive_svg__fil0",rx:65.14,ry:6.93})),n.createElement("path",{d:"m255.56 226.72 112.79 56.39c4.05 2.03 6.45 5.92 6.45 10.44 0 4.53-2.4 8.41-6.45 10.44l-112.79 56.39c-3.72 1.86-7.81 1.67-11.36-.51-3.53-2.19-5.52-5.77-5.52-9.93V237.15c0-4.16 2-7.74 5.52-9.93 3.55-2.18 7.64-2.37 11.36-.51z",style:{fill:"#8cec82"}}),n.createElement("path",{d:"M257.92 231.07c35.15 17.57 70.29 35.15 105.44 52.72 3.79 1.9 6.03 5.53 6.03 9.76s-2.25 7.86-6.03 9.76c-35.15 17.57-70.3 35.15-105.44 52.72-3.48 1.73-7.3 1.56-10.62-.48-3.3-2.05-5.17-5.4-5.17-9.29V240.82c0-3.89 1.87-7.23 5.17-9.29 3.31-2.04 7.14-2.21 10.62-.48z",style:{fill:"#7edd74"}}),n.createElement("path",{d:"m260.28 235.42 98.1 49.05c3.53 1.77 5.61 5.15 5.61 9.08 0 3.94-2.08 7.32-5.61 9.08-32.69 16.35-65.4 32.69-98.1 49.05-3.24 1.61-6.79 1.45-9.88-.45-3.07-1.91-4.81-5.02-4.81-8.63v-98.1c0-3.62 1.74-6.73 4.81-8.63 3.09-1.9 6.64-2.06 9.88-.45",style:{fill:"#6fce65"}}),n.createElement("path",{d:"M262.64 239.78c30.25 15.12 60.5 30.25 90.75 45.37 3.26 1.63 5.19 4.76 5.19 8.4s-1.93 6.77-5.19 8.4c-30.25 15.12-60.5 30.25-90.75 45.37-2.99 1.49-6.28 1.35-9.14-.41-2.84-1.77-4.45-4.64-4.45-7.99v-90.74c0-3.35 1.61-6.23 4.45-7.99 2.85-1.76 6.14-1.9 9.14-.41",style:{fill:"#61c057"}}),n.createElement("path",{d:"M265.01 244.13c27.8 13.9 55.6 27.8 83.41 41.7 2.99 1.5 4.77 4.37 4.77 7.72s-1.78 6.22-4.77 7.72c-27.81 13.9-55.61 27.81-83.41 41.7-2.75 1.38-5.78 1.24-8.4-.37-2.61-1.62-4.09-4.26-4.09-7.35v-83.41c0-3.08 1.48-5.72 4.09-7.35 2.62-1.61 5.65-1.75 8.4-.37z",style:{fill:"#52b149"}}),n.createElement("path",{d:"M267.36 248.48c25.36 12.68 50.71 25.36 76.06 38.03 2.74 1.37 4.35 3.99 4.35 7.04s-1.62 5.67-4.35 7.04c-25.35 12.67-50.7 25.35-76.06 38.03-2.51 1.25-5.27 1.13-7.65-.34-2.39-1.48-3.73-3.89-3.73-6.7v-76.05c0-2.81 1.35-5.22 3.73-6.7 2.39-1.48 5.15-1.6 7.65-.34z",style:{fill:"#44a23a"}}),n.createElement("path",{d:"m269.73 252.84 68.71 34.36c2.47 1.24 3.93 3.6 3.93 6.36s-1.46 5.12-3.93 6.36l-68.71 34.36c-2.27 1.13-4.76 1.02-6.92-.31-2.15-1.34-3.37-3.51-3.37-6.05v-68.71c0-2.54 1.22-4.71 3.37-6.05 2.16-1.33 4.65-1.44 6.92-.31z",style:{fill:"#35932c"}}),n.createElement("path",{d:"m256.55 224.73 112.79 56.4c2.4 1.2 4.33 2.97 5.64 5.1 1.32 2.14 2.04 4.65 2.04 7.32s-.72 5.18-2.05 7.32c-1.3 2.13-3.23 3.9-5.64 5.1l-112.79 56.39c-2.19 1.1-4.53 1.59-6.83 1.5-2.31-.1-4.59-.81-6.69-2.1-2.09-1.31-3.75-3.03-4.87-5.04s-1.72-4.33-1.72-6.78V237.15c0-2.45.6-4.77 1.72-6.78 1.11-2.01 2.77-3.73 4.87-5.03 2.09-1.3 4.38-2.01 6.68-2.11 2.3-.09 4.64.4 6.83 1.49zm110.8 60.35-112.78-56.39c-1.52-.74-3.12-1.09-4.67-1.02-1.54.06-3.1.56-4.54 1.45-1.43.88-2.56 2.06-3.31 3.42-.75 1.34-1.15 2.92-1.15 4.62v112.79c0 1.7.4 3.28 1.15 4.62.75 1.36 1.88 2.54 3.31 3.42 1.44.88 3 1.38 4.54 1.44 1.55.06 3.14-.28 4.66-1.03l112.79-56.38c1.64-.82 2.96-2.02 3.84-3.47.89-1.43 1.38-3.14 1.38-5s-.48-3.57-1.37-5c-.89-1.44-2.21-2.64-3.85-3.47",style:{fill:"#002700",fillRule:"nonzero"}}))))}),"Archive",32,32),Live:Ae((function(e){return n.createElement("svg",Ie({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),ve||(ve=n.createElement("path",{fill:"currentColor",d:"M16 6V4a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v2zm0 2H8c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2m-4 9c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3"})))}),"Live",20,20),Play:Ae((function(e){return n.createElement("svg",Be({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),me||(me=n.createElement("path",{fill:"currentColor",d:"M8 5v14l11-7z"})))}),"Play",20,20),Pause:Ae((function(e){return n.createElement("svg",ze({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),pe||(pe=n.createElement("path",{fill:"currentColor",d:"M6 19h4V5H6zm8-14v14h4V5z"})))}),"Pause",20,20),Export:Ae((function(e){return n.createElement("svg",Ge({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 16 16"},e),ye||(ye=n.createElement("path",{fill:"#fff",d:"M14 11v3H2v-3H0v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3zm-1-4-1.41-1.41L9 8.17V0H7v8.17L4.41 5.59 3 7l5 5z"})))}),"Export",16,16),Mute:Ae((function(e){return n.createElement("svg",He({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 20 16"},e),ge||(ge=n.createElement("path",{fill:"#fff",d:"M3.707.293a1 1 0 0 0-1.414 1.414l14 14a1 1 0 0 0 1.414-1.414l-.004-.005C19.57 12.498 20 9.938 20 8A9.97 9.97 0 0 0 17.071.929a1 1 0 1 0-1.414 1.414A7.97 7.97 0 0 1 18 8c0 1.752-.403 3.636-1.712 4.873l-1.433-1.433C15.616 10.37 16 9.107 16 8c0-1.678-.69-3.197-1.8-4.285a1 1 0 1 0-1.4 1.428A4 4 0 0 1 14 8c0 .606-.195 1.335-.59 1.996L11 7.586V2.135C11 .439 9.022-.487 7.72.599L5.698 2.284 3.708.293zM2 4h.586L11 12.414v1.451c0 1.696-1.978 2.622-3.28 1.536L3.638 12H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2"})))}),"Mute",20,15),Unmute:Ae((function(e){return n.createElement("svg",Ue({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),be||(be=n.createElement("path",{fill:"#fff",d:"M10.757 3c1.043 0 2.017.752 2.368 1.956.13.503.181 1.008.232 1.494l.048.443c.18 1.476.18 8.729 0 10.215l-.048.458c-.045.463-.092.943-.225 1.454-.351 1.2-1.287 1.98-2.35 1.98l-.105-.001c-.587 0-1.226-.361-1.588-.676l-3.526-2.94h-1.81c-1.398 0-2.422-1.012-2.608-2.578-.214-1.567-.172-4.254 0-5.678.202-1.483 1.275-2.51 2.607-2.51h1.81l3.46-2.897c.417-.363 1.153-.722 1.735-.72m8.533.22a.905.905 0 0 1 1.277.237C22.136 5.767 23 8.802 23 12c0 3.2-.864 6.235-2.433 8.544a.902.902 0 0 1-1.275.236.96.96 0 0 1-.232-1.307c1.357-2 2.105-4.654 2.105-7.473s-.748-5.473-2.105-7.472a.96.96 0 0 1 .23-1.307M16.128 6.26a.907.907 0 0 1 1.279.235c1.012 1.492 1.572 3.448 1.572 5.506s-.56 4.014-1.572 5.506a.906.906 0 0 1-1.277.235.956.956 0 0 1-.23-1.307c.802-1.182 1.243-2.757 1.243-4.434s-.441-3.252-1.243-4.434a.957.957 0 0 1 .228-1.307"})))}),"Unmute",20,20),Fullscreen:Ae((function(e){return n.createElement("svg",Ve({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 20 20"},e),we||(we=n.createElement("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M1 6V1h5m8 0h5v5m0 8v5h-5m-8 0H1v-5"})))}),"Fullscreen",18,18),FullscreenExit:Ae((function(e){return n.createElement("svg",We({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),xe||(xe=n.createElement("path",{fill:"currentColor",d:"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"})))}),"FullscreenExit",20,20),Record:Ae((function(e){return n.createElement("svg",Ye({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),Te||(Te=n.createElement("path",{fill:"currentColor",d:"m20.54 5.23-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27M12 17.5 6.5 12H10v-2h4v2h3.5zM5.93 4 7 5h10l1.07-1z"})))}),"Record",20,20),CenterTimeline:Ae((function(e){return n.createElement("svg",Xe({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 20 20"},e),Ee||(Ee=n.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M10 2a8 8 0 1 0 0 16 8 8 0 0 0 0-16"})),je||(je=n.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M10 5v5l3 3M3 10h2M15 10h2M10 3v2M10 15v2"})))}),"CenterTimeline",20,20),ChangeToPoster:Ae((function(e){return n.createElement("svg",qe({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 20 20"},e),Se||(Se=n.createElement("rect",{width:16,height:12,x:2,y:4,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,rx:1})),Le||(Le=n.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2 7h16M6 2v2M14 2v2M6 11l3 2.5 5-4"})))}),"ChangeToPoster",20,20),ArrowBack:Ae((function(e){return n.createElement("svg",Je({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 5 10"},e),ke||(ke=n.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M.229 5.474 4 9.245l.943-.942-3.3-3.3 3.3-3.3L4 .76.229 4.531a.667.667 0 0 0 0 .943",clipRule:"evenodd"})))}),"ArrowBack",20,20),Check:Ae((function(e){return n.createElement("svg",$e({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 11 9"},e),Oe||(Oe=n.createElement("path",{fill:"#fff",d:"M4.073 8.508a.67.67 0 0 1-.486-.214L.347 4.848a.667.667 0 1 1 .973-.914l2.747 2.927L9.673.728a.667.667 0 1 1 .987.893L4.567 8.288a.67.67 0 0 1-.487.22z"})))}),"Check",11,9)};const Qe="controlButton--XgIHz";var Ze=r(961);const et={container:"container--kyl_a",trigger:"trigger--i375V",disabled:"disabled--Sgyuo",dropdown:"dropdown--RKT9D",header:"header--K_52D",backButton:"backButton--xLRvQ",title:"title--DV_8B",divider:"divider--A50oz",options:"options--NREQJ",option:"option--JaopH",optionLabel:"optionLabel--vyJWK"};function tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return rt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var nt=[{value:1,label:"Обычная",controlLabel:"1x"},{value:1.25,label:"1.25x"},{value:1.5,label:"1.5x"},{value:1.75,label:"1.75x"},{value:2,label:"2x"},{value:4,label:"4x"}],ot=function(e){var t=e.playbackSpeed,r=e.onSpeedChange,o=e.disabled,i=void 0!==o&&o,a=e.isFullscreen,c=void 0!==a&&a,u=tt((0,n.useState)(!1),2),l=u[0],s=u[1],f=(0,n.useRef)(null),d=(0,n.useRef)(null),h=tt((0,n.useState)({top:0,left:0,width:0}),2),v=h[0],m=h[1],p=function(e){r(e),s(!1)},y=function(){s(!1)},g=function(e){var t;!d.current||d.current.contains(e.target)||null!==(t=f.current)&&void 0!==t&&t.contains(e.target)||s(!1)};(0,n.useEffect)((function(){return l&&document.addEventListener("mousedown",g),function(){document.removeEventListener("mousedown",g)}}),[l]);var b,w=function(){var e;return(null===(e=nt.find((function(e){return e.value===t})))||void 0===e?void 0:e.value)||t};return(0,N.jsxs)("div",{style:{position:"relative"},children:[(0,N.jsx)("div",{className:et.container,ref:d,children:(0,N.jsx)("button",{className:"".concat(et.trigger," ").concat(i?et.disabled:""),onClick:function(){if(!i){if(!l&&d.current){var e=d.current.getBoundingClientRect();m({top:e.top-253,left:e.right-165,width:e.width})}s(!l)}},disabled:i,"aria-label":"Выбрать скорость воспроизведения",children:(b=nt.find((function(e){return e.value===t})),null!=b&&b.controlLabel?b.controlLabel:null!=b&&b.label?b.label:"".concat(t,"x"))})}),l&&(c?(0,N.jsxs)("div",{className:et.dropdown,ref:f,style:{position:"absolute",bottom:"53px",right:"0px",zIndex:99999},children:[(0,N.jsxs)("div",{className:et.header,children:[(0,N.jsx)("button",{className:et.backButton,onClick:y,"aria-label":"Назад",children:(0,N.jsx)(Ke.ArrowBack,{})}),(0,N.jsx)("span",{className:et.title,children:"Скорость"})]}),(0,N.jsx)("div",{className:et.divider}),(0,N.jsx)("div",{className:et.options,children:nt.map((function(e){return(0,N.jsxs)("button",{className:"".concat(et.option," ").concat(w()===e.value?et.selected:""),onClick:function(){return p(e.value)},"aria-label":"Скорость ".concat(e.label),children:[w()===e.value&&(0,N.jsx)(Ke.Check,{}),(0,N.jsx)("span",{className:et.optionLabel,children:e.label})]},e.value)}))})]}):(0,Ze.createPortal)((0,N.jsxs)("div",{className:et.dropdown,ref:f,style:{position:"fixed",top:"".concat(v.top,"px"),left:"".concat(v.left,"px"),zIndex:99999},children:[(0,N.jsxs)("div",{className:et.header,children:[(0,N.jsx)("button",{className:et.backButton,onClick:y,"aria-label":"Назад",children:(0,N.jsx)(Ke.ArrowBack,{})}),(0,N.jsx)("span",{className:et.title,children:"Скорость"})]}),(0,N.jsx)("div",{className:et.divider}),(0,N.jsx)("div",{className:et.options,children:nt.map((function(e){return(0,N.jsxs)("button",{className:"".concat(et.option," ").concat(w()===e.value?et.selected:""),onClick:function(){return p(e.value)},"aria-label":"Скорость ".concat(e.label),children:[w()===e.value&&(0,N.jsx)(Ke.Check,{}),(0,N.jsx)("span",{className:et.optionLabel,children:e.label})]},e.value)}))})]}),document.body))]})};function it(e){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},it(e)}function at(){at=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),c=new C(n||[]);return o(a,"_invoke",{value:L(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",h="suspendedYield",v="executing",m="completed",p={};function y(){}function g(){}function b(){}var w={};l(w,a,(function(){return this}));var x=Object.getPrototypeOf,T=x&&x(x(M([])));T&&T!==r&&n.call(T,a)&&(w=T);var E=b.prototype=y.prototype=Object.create(w);function j(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==it(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=k(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var l=f(t,r,n);if("normal"===l.type){if(o=n.done?m:h,l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function k(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function M(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(it(t)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},j(S.prototype),l(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new S(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},j(E),l(E,u,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=M,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:M(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function ct(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=st(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function ut(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||st(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(e,t){if(e){if("string"==typeof e)return ft(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ft(e,t):void 0}}function ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}(0,Pe.registerLocale)("ru",Me.ru);var dt=function(e){var t=e.mode,r=e.isPlaying,o=e.isMuted,a=e.isFullscreen,u=e.isNoSound,l=e.isDownloadAccess,s=e.playbackSpeed,f=e.url,d=e.port,h=e.credentials,v=e.camera,m=e.protocol,p=e.onPlayPause,y=e.onMuteToggle,g=e.onSpeedChange,b=e.onChangeStartDate,w=e.onSaveStream,x=e.onToggleFullscreen,E=e.onChangeMode,j=e.disableSpeedChange,S=void 0!==j&&j,L=$(),k=L.hasTimelineAccess,O=L.setTimelineAccess,P=lt((0,n.useState)(new Date),2),C=P[0],M=P[1],_=(0,n.useRef)(null),R=lt((0,n.useState)([]),2),A=R[0],D=R[1],F=(0,n.useRef)(new Set),I=function(e){return(0,c.GP)(e,"yyyy-MM-dd")},B=function(e){return(0,c.GP)(e,"yyyy-MM")},z=(0,n.useMemo)((function(){return new Set(A.map(I))}),[A]),G=function(){var e,t=(e=at().mark((function e(t){var r,n,o,i,a,c,u,l;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f&&d&&h&&k){e.next=2;break}return e.abrupt("return");case 2:if(r=B(t),!F.current.has(r)){e.next=5;break}return e.abrupt("return");case 5:return n=(0,_e.w)(t),o=(0,_e.w)((0,Re.P)(t,1)),e.prev=7,e.next=10,T({url:f,port:d,credentials:h,startTime:(0,Ne.o)(n),endTime:(0,Ne.o)(o),unitLength:86400,channel:v,protocol:m});case 10:for(i=e.sent,a=[],c=i.timeline.length,u=0;u<c;u+=1)i.timeline[u]>0&&((l=new Date(n)).setDate(n.getDate()+u),a.push(l));D((function(e){var t,r=new Map,n=ct(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;r.set(I(o),o)}}catch(e){n.e(e)}finally{n.f()}for(var i=0,c=a;i<c.length;i++){var u=c[i];r.set(I(u),u)}return Array.from(r.values()).sort((function(e,t){return e.getTime()-t.getTime()}))})),F.current.add(r),e.next=23;break;case 18:if(e.prev=18,e.t0=e.catch(7),!(e.t0 instanceof Error&&"FORBIDDEN"===e.t0.message)){e.next=23;break}return O(!1),e.abrupt("return");case 23:case"end":return e.stop()}}),e,null,[[7,18]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ut(i,n,o,a,c,"next",e)}function c(e){ut(i,n,o,a,c,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return(0,N.jsxs)("div",{className:"controls--ZbSml",children:[(0,N.jsxs)("div",{className:"leftControls--AAkLC",children:[(0,N.jsx)("button",{className:Qe,onClick:p,children:r?(0,N.jsx)(Ke.Pause,{}):(0,N.jsx)(Ke.Play,{})}),!u&&(0,N.jsx)("button",{className:Qe,onClick:y,children:o?(0,N.jsx)(Ke.Mute,{}):(0,N.jsx)(Ke.Unmute,{})}),t===i.Record&&(0,N.jsx)("button",{className:"recordButton--lkzUK",onClick:function(){return null==E?void 0:E(i.Live)},children:(0,N.jsx)("span",{className:"liveButton--mKCNa",children:"live"})})]}),(0,N.jsxs)("div",{className:"rightControls--WZNLL",children:[k&&(0,N.jsx)(Ce(),{ref:_,selected:C,customInput:(0,N.jsx)("button",{className:Qe,children:(0,N.jsx)(Ke.Datepicker,{})}),locale:Me.ru,showTimeSelect:!0,timeIntervals:10,timeFormat:"HH:mm",showTimeCaption:!1,shouldCloseOnSelect:!0,popperPlacement:"top",calendarClassName:"custom-datepicker",highlightDates:A.length?[{"highlighted-date":A}]:void 0,filterDate:function(e){return 0===z.size||z.has(I(e))},onChange:function(e){return function(e){var t;e&&(M(e),b&&b(e),null===(t=_.current)||void 0===t||t.setOpen(!1))}(e)},onCalendarOpen:function(){G(C)},onMonthChange:function(e){G(e)}}),l&&(0,N.jsx)("button",{className:Qe,onClick:w,children:(0,N.jsx)(Ke.Export,{})}),t===i.Record&&(0,N.jsx)(ot,{playbackSpeed:s,onSpeedChange:g,disabled:S,isFullscreen:a}),(0,N.jsx)("button",{className:Qe,onClick:x,children:a?(0,N.jsx)(Ke.FullscreenExit,{}):(0,N.jsx)(Ke.Fullscreen,{})})]})]})};var ht=function(e){var t=e.mode,r=e.isPlaying,o=e.isMuted,i=e.isFullscreen,a=e.isNoSound,c=e.playbackSpeed,u=e.url,l=e.port,s=e.credentials,f=e.progress,d=e.camera,h=e.protocol,v=e.onPlayPause,m=e.onMuteToggle,p=e.onSpeedChange,y=e.onSaveStream,g=e.onTimeClick,b=e.onChangeStartDate,w=e.onToggleFullscreen,x=e.disableSpeedChange,T=void 0!==x&&x,E=e.disableCenterTimeline,j=void 0!==E&&E,S=e.onChangeMode,L=$().hasTimelineAccess,k=(0,n.useRef)(null);return(0,N.jsxs)("div",{className:"controlPanel--yKWjp",children:[(0,N.jsx)(dt,{mode:t,isPlaying:r,isMuted:o,isFullscreen:i,isNoSound:a,isDownloadAccess:L,playbackSpeed:c,url:u,port:l,credentials:s,camera:d,protocol:h,onPlayPause:v,onMuteToggle:m,onSpeedChange:p,onCenterTimeline:L?function(){var e;return null===(e=k.current)||void 0===e?void 0:e.centerOnCurrentTime()}:void 0,onChangeStartDate:b,onSaveStream:y,onToggleFullscreen:w,disableSpeedChange:T,disableCenterTimeline:j,onChangeMode:S}),L&&(0,N.jsx)(ie,{ref:k,url:u,port:l,credentials:s,onTimeClick:g,progress:f,camera:d,mode:t})]})},vt=r(4945);var mt=function(e){var t=e.onClick,r=e.text;return(0,N.jsx)("div",{className:"playOverlay--ZerDl",onClick:t,children:(0,N.jsxs)("div",{className:"content--UWBbf",children:[(0,N.jsx)("button",{className:"playButton--f3Los",children:(0,N.jsx)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,N.jsx)("path",{d:"M8 5V19L19 12L8 5Z",fill:"white"})})}),r&&(0,N.jsx)("div",{className:"label--xSGQj",children:r})]})})};var pt=function(e){var t=e.message,r=void 0===t?"Загрузка видео...":t;return(0,N.jsx)("div",{className:"loaderContainer--XdL4L",children:(0,N.jsx)("div",{className:"loader--kP27q",children:(0,N.jsx)("span",{children:r})})})};var yt=function(e){var t=e.children;return(0,N.jsx)("div",{className:"videoContainer--aUkGL",children:t})};function gt(e){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(e)}function bt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(r),!0).forEach((function(t){xt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xt(e,t,r){return(t=function(e){var t=function(e){if("object"!=gt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=gt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==gt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Et(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Et(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var jt=(0,n.forwardRef)((function(e,t){var r=e.url,o=e.playing,i=void 0!==o&&o,a=e.onProgress,c=e.onPlayPause,u=e.playbackSpeed,l=e.muted,s=void 0===l||l,f=e.overlayText,d=(0,n.useRef)(null),h=(0,n.useRef)(null),v=Tt((0,n.useState)(!0),2),m=v[0],p=v[1],y=Tt((0,n.useState)(!1),2),g=y[0],b=y[1],w=(0,n.useRef)(null),x=(0,n.useRef)(null),T=(0,n.useRef)(0),E=(0,n.useRef)(0),j=(0,n.useRef)(0),S=(0,n.useRef)(0),L=(0,n.useRef)(i),k=(0,n.useRef)(s);(0,n.useImperativeHandle)(t,(function(){return{seekBy:function(e){var t=d.current;if(t)try{var r=Number.isFinite(t.duration)?t.duration:void 0,n=Math.max(0,(t.currentTime||0)+e);t.currentTime=r?Math.min(n,r):n}catch(e){}}}})),(0,n.useEffect)((function(){i!==L.current&&(L.current=i,O())}),[i,L]),(0,n.useEffect)((function(){k.current=s,P()}),[s,k]),(0,n.useEffect)((function(){d.current&&(d.current.playbackRate=u||1)}),[u]);var O=function(){var e=d.current;e&&(L.current?m||e.play().catch((function(e){console.error("Ошибка при попытке воспроизведения:",e)})):e.pause())},P=function(){d.current&&(d.current.muted=k.current)};return(0,n.useEffect)((function(){var e=d.current;if(e){if(h.current&&h.current.destroy(),p(!0),S.current=0,vt.Ay.isSupported()){var t=new vt.Ay({debug:!1,manifestLoadPolicy:{default:{maxLoadTimeMs:2e4,maxTimeToFirstByteMs:8e3,timeoutRetry:{maxNumRetry:5,retryDelayMs:500,maxRetryDelayMs:2e3},errorRetry:{maxNumRetry:5,retryDelayMs:500,maxRetryDelayMs:2e3}}},playlistLoadPolicy:{default:{maxLoadTimeMs:2e4,maxTimeToFirstByteMs:8e3,timeoutRetry:{maxNumRetry:5,retryDelayMs:500,maxRetryDelayMs:2e3},errorRetry:{maxNumRetry:5,retryDelayMs:500,maxRetryDelayMs:2e3}}},fragLoadPolicy:{default:{maxLoadTimeMs:12e4,maxTimeToFirstByteMs:8e3,timeoutRetry:{maxNumRetry:5,retryDelayMs:500,maxRetryDelayMs:2e3},errorRetry:{maxNumRetry:5,retryDelayMs:500,maxRetryDelayMs:2e3}}},maxBufferSize:3e7,maxBufferLength:30,maxMaxBufferLength:60,startLevel:-1,capLevelToPlayerSize:!0,enableWorker:!0,lowLatencyMode:!0,backBufferLength:30,enableSoftwareAES:!0,testBandwidth:!0,abrEwmaDefaultEstimate:5e5,abrEwmaFastLive:3,abrEwmaSlowLive:9,startFragPrefetch:!0,fragLoadingMaxRetry:5,manifestLoadingMaxRetry:5,levelLoadingMaxRetry:5,fragLoadingRetryDelay:1e3,manifestLoadingRetryDelay:1e3,levelLoadingRetryDelay:1e3});h.current=t,t.on(vt.Ay.Events.FRAG_LOADING,(function(e,t){console.log("Loading fragment:",{level:t.frag.level,sn:t.frag.sn,start:t.frag.start,duration:t.frag.duration}),j.current++,x.current&&clearTimeout(x.current)})),t.on(vt.Ay.Events.FRAG_LOADED,(function(e,t){console.log("Fragment loaded:",{level:t.frag.level,sn:t.frag.sn,loadDuration:t.frag.stats.total}),j.current=Math.max(0,j.current-1),x.current&&clearTimeout(x.current)})),t.on(vt.Ay.Events.ERROR,(function(n,i){if(i.fatal){var a={type:i.type,details:i.details,fatal:i.fatal,buffer:e.buffered.length>0?{start:e.buffered.start(0),end:e.buffered.end(0)}:null,currentTime:e.currentTime,readyState:e.readyState,networkState:e.networkState,error:e.error};console.error("HLS Ошибка:",a),setTimeout((function(){switch(i.type){case vt.Ay.ErrorTypes.NETWORK_ERROR:i.details===vt.Ay.ErrorDetails.MANIFEST_LOAD_ERROR||i.details===vt.Ay.ErrorDetails.MANIFEST_LOAD_TIMEOUT?(console.log("Ошибка загрузки манифеста, повторная попытка..."),setTimeout((function(){t.loadSource(r),t.startLoad()}),1e3)):(console.log("Сетевая ошибка, пытаемся восстановить..."),t.startLoad());break;case vt.Ay.ErrorTypes.MEDIA_ERROR:console.log("Ошибка медиа, пытаемся восстановить..."),o();break;default:console.error("Неизвестная ошибка, уничтожаем плеер"),t.destroy()}}),1e3)}})),t.on(vt.Ay.Events.MANIFEST_PARSED,(function(){p(!1),e.playbackRate!==(u||1)&&(e.playbackRate=u||1),L.current&&e.play().catch(console.error)})),t.loadSource(r),t.attachMedia(e);var n=setInterval((function(){if(e&&!e.paused){for(var t=e.buffered,r=e.currentTime,n=[],o=0;o<t.length;o++)n.push({start:t.start(o),end:t.end(o)});for(var i=!1,a=0;a<t.length;a++)if(r>=t.start(a)&&r<t.end(a)&&t.end(a)>r+.5){i=!0;break}E.current,r!==T.current||i?(g&&console.log("Buffering ended:",{currentTime:r,buffered:n}),E.current=0,b(!1)):(E.current++,E.current>=2&&(b(!0),console.warn("Buffering started:",{currentTime:r,buffered:n,stallCount:E.current}))),T.current=r}else b(!1)}),1e3);e.addEventListener("error",(function(t){console.error("Video Error:",{error:e.error,event:t,currentTime:e.currentTime,readyState:e.readyState,networkState:e.networkState})}));var o=function(){if(S.current>=3)return console.error("Достигнуто максимальное количество попыток восстановления, уничтожаем плеер"),t.destroy(),p(!0),void setTimeout((function(){var n=new vt.Ay(wt(wt({},t.config),{},{enableWorker:!1,maxBufferLength:15,maxMaxBufferLength:30}));h.current=n,n.loadSource(r),n.attachMedia(e),e.playbackRate=u||1,p(!1)}),2e3);if(S.current++,console.log("Попытка восстановления #".concat(S.current)),e.buffered.length)try{e.currentTime=e.buffered.end(e.buffered.length-1)+.1}catch(e){console.error("Ошибка при попытке изменить currentTime:",e)}setTimeout((function(){switch(S.current){case 1:t.recoverMediaError(),e.playbackRate=u||1;break;case 2:e.currentTime=e.currentTime,t.recoverMediaError(),e.playbackRate=u||1;break;case 3:var n=e.currentTime;t.destroy();var o=new vt.Ay(wt(wt({},t.config),{},{startPosition:n,enableWorker:!1,maxBufferLength:15}));h.current=o,o.loadSource(r),o.attachMedia(e),setTimeout((function(){e.playbackRate=u||1}),100)}}),1e3*S.current)};t.on(vt.Ay.Events.FRAG_LOADED,(function(){S.current>0&&(console.log("Воспроизведение успешно восстановлено"),e.playbackRate!==u&&(e.playbackRate=u||1),setTimeout((function(){e.error||(S.current=0)}),5e3))}));var i=function(t){var r;console.error("Video Error:",{error:e.error,event:t,currentTime:e.currentTime,readyState:e.readyState,networkState:e.networkState,recoveryAttempts:S.current}),3===(null===(r=e.error)||void 0===r?void 0:r.code)&&o()};return e.addEventListener("error",i),function(){e.removeEventListener("error",i),clearInterval(n),w.current&&clearTimeout(w.current),x.current&&clearTimeout(x.current),h.current&&h.current.destroy(),E.current=0,T.current=0,j.current=0,S.current=0}}e.canPlayType("application/vnd.apple.mpegurl")&&(e.src=r)}}),[r]),(0,N.jsxs)(yt,{children:[(m||g)&&(0,N.jsx)(pt,{message:m?"Загрузка видео...":"Буферизация..."}),!L.current&&!m&&!g&&(0,N.jsx)(mt,{text:f,onClick:function(){return null==c?void 0:c(!0)}}),(0,N.jsx)("video",{"data-type":"hls",ref:d,onClick:function(){return null==c?void 0:c(!1)},controls:!1,controlsList:"nodownload nofullscreen noremoteplayback",onTimeUpdate:function(){d.current&&a&&a({currentTime:d.current.currentTime,duration:d.current.duration})},playsInline:!0,muted:k.current,autoPlay:!1,"aria-label":"HLS video player"})]})}));function St(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Lt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}jt.displayName="HlsPlayer";var kt=(0,n.forwardRef)((function(e,t){var r=e.url,o=e.playing,i=void 0===o||o,a=e.muted,c=void 0===a||a,u=e.posterUrl,l=e.onProgress,s=e.onPlayPause,f=e.overlayText,d=(0,n.useRef)(null),h=St((0,n.useState)(!0),2),v=h[0],m=h[1],p=St((0,n.useState)(!1),2),y=p[0],g=p[1],b=(0,n.useRef)(null),w=(0,n.useRef)(0),x=(0,n.useRef)(0),T=(0,n.useRef)(!1),E=(0,n.useRef)(i),j=(0,n.useRef)(c);(0,n.useImperativeHandle)(t,(function(){return{seekBy:function(e){var t=d.current;if(t)try{var r=Number.isFinite(t.duration)?t.duration:void 0,n=Math.max(0,(t.currentTime||0)+e);t.currentTime=r?Math.min(n,r):n}catch(e){}}}}));var S=function(){d.current&&l&&l({currentTime:d.current.currentTime,duration:d.current.duration||0})};return(0,n.useEffect)((function(){i!==E.current&&(E.current=i,d.current&&(E.current?d.current.play().catch((function(e){console.error("Ошибка при попытке воспроизведения:",e)})):d.current.pause()))}),[i,E]),(0,n.useEffect)((function(){j.current=c,d.current&&(d.current.muted=j.current)}),[c,j]),(0,n.useEffect)((function(){var e=d.current;if(e){T.current=!1,m(!0);var t=function(){return m(!0)},n=function(){m(!1),E.current&&e.paused&&e.play().catch((function(e){console.error("Ошибка при автовоспроизведении:",e)}))},o=function(){return null==s?void 0:s(!0)},i=function(){return null==s?void 0:s(!1)},a=function(){return null==s?void 0:s(!1)},l=function(e){console.error("Ошибка воспроизведения видео:",e),m(!1)};e.src=r,e.muted=c,u&&(e.poster=u),e.addEventListener("loadstart",t),e.addEventListener("canplay",n),e.addEventListener("play",o),e.addEventListener("pause",i),e.addEventListener("ended",a),e.addEventListener("error",l),e.addEventListener("timeupdate",S);var f=setInterval((function(){if(e&&!e.paused){for(var t=e.buffered,r=e.currentTime,n=!1,o=0;o<t.length;o++)if(r>=t.start(o)&&r<t.end(o)&&t.end(o)>r+.5){n=!0;break}r!==w.current||n?(x.current=0,g(!1)):(x.current++,x.current>=2&&g(!0)),w.current=r}else g(!1)}),1e3);return e.load(),function(){e.removeEventListener("loadstart",t),e.removeEventListener("canplay",n),e.removeEventListener("play",o),e.removeEventListener("pause",i),e.removeEventListener("ended",a),e.removeEventListener("error",l),e.removeEventListener("timeupdate",S),clearInterval(f),b.current&&clearTimeout(b.current),e.pause(),e.src="",x.current=0,w.current=0}}}),[r,u]),(0,N.jsxs)(yt,{children:[(v||y)&&(0,N.jsx)(pt,{message:v?"Загрузка видео...":"Буферизация..."}),!E.current&&!v&&!y&&(0,N.jsx)(mt,{onClick:function(){return null==s?void 0:s(!0)},text:f}),(0,N.jsx)("video",{"data-type":"video",onClick:function(){return null==s?void 0:s(!1)},ref:d,controls:!1,controlsList:"nodownload nofullscreen noremoteplayback",playsInline:!0,muted:c,poster:u,autoPlay:i})]})}));kt.displayName="VideoTag";const Ot={modalContainer:"modalContainer--QjxRO",trigger:"trigger--z1WTq",modalOverlay:"modalOverlay--dduRc",modal:"modal--VX8xO",mb1:"mb1--QFlOi",mt2:"mt2--eOX8D",close:"close--Rtcxj",saveBtn:"saveBtn--T2qQb"};function Pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ct(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ct(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}(0,Pe.registerLocale)("ru",Me.ru);var Mt=function(e){var t=e.isOpen,r=e.onClose,o=e.onFinish,i=e.currentTime,a=(0,n.useRef)(null),c=Pt((0,n.useState)(f(i,-2)),2),u=c[0],l=c[1],s=Pt((0,n.useState)(f(i,2)),2),d=s[0],h=s[1];return(0,n.useEffect)((function(){var e=function(e){a.current&&!a.current.contains(e.target)&&r()};return t&&document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[t,r]),(0,n.useEffect)((function(){var e=function(e){"Escape"===e.key&&r()};return t&&document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[t,r]),t?(0,N.jsx)("div",{className:Ot.modalOverlay,children:(0,N.jsxs)("div",{className:Ot.modal,ref:a,children:[(0,N.jsx)("button",{className:Ot.close,onClick:r,children:"×"}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:Ot.mb1,children:"Начало периода"}),(0,N.jsx)(Ce(),{selected:u,locale:Me.ru,showTimeSelect:!0,timeIntervals:10,dateFormat:"dd.MM.yyyy HH:mm:ss",showTimeCaption:!1,onChange:function(e){return function(e){e&&l(e)}(e)},popperClassName:Ot.datePickerPopper,calendarClassName:Ot.datePickerCalendar,customInput:(0,N.jsx)("input",{type:"text",className:Ot.datePickerInput})})]}),(0,N.jsxs)("div",{className:Ot.mt2,children:[(0,N.jsx)("h3",{className:Ot.mb1,children:"Окончание периода"}),(0,N.jsx)(Ce(),{selected:d,locale:Me.ru,showTimeSelect:!0,timeIntervals:10,dateFormat:"dd.MM.yyyy HH:mm:ss",showTimeCaption:!1,onChange:function(e){return function(e){e&&h(e)}(e)},popperClassName:Ot.datePickerPopper,calendarClassName:Ot.datePickerCalendar,customInput:(0,N.jsx)("input",{type:"text",className:Ot.datePickerInput})})]}),(0,N.jsx)("button",{className:Ot.saveBtn,onClick:function(){o&&o(u,d),r()},children:"Сохранить"})]})}):null};var _t=function(e){var t=e.mode,r=e.isPlaying,n="live"===t?"LIVE":"PLAYBACK",o="".concat("statusDot--EO6FY"," ").concat(r?"live"===t?"blinkGreen--HjRCs":"blinkRed--Y26YS":"paused--VdMtR");return(0,N.jsxs)("div",{className:"modeIndicator--XU_oy",children:[(0,N.jsx)("span",{className:"label--oBufw",children:n}),(0,N.jsx)("span",{className:o})]})};const Rt="overlayCard--CPnLq",Nt="overlayTitle--OZB9J",At="label--umB1e",Dt="input--ElB3a";function Ft(e){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ft(e)}function It(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Bt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?It(Object(r),!0).forEach((function(t){zt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function zt(e,t,r){return(t=function(e){var t=function(e){if("object"!=Ft(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ft(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gt(){Gt=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),c=new C(n||[]);return o(a,"_invoke",{value:L(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",h="suspendedYield",v="executing",m="completed",p={};function y(){}function g(){}function b(){}var w={};l(w,a,(function(){return this}));var x=Object.getPrototypeOf,T=x&&x(x(M([])));T&&T!==r&&n.call(T,a)&&(w=T);var E=b.prototype=y.prototype=Object.create(w);function j(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==Ft(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=k(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var l=f(t,r,n);if("normal"===l.type){if(o=n.done?m:h,l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function k(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function M(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Ft(t)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},j(S.prototype),l(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new S(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},j(E),l(E,u,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=M,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:M(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function Ht(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function Ut(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Ht(i,n,o,a,c,"next",e)}function c(e){Ht(i,n,o,a,c,"throw",e)}a(void 0)}))}}function Vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Yt=function(e){var t,r=e.streamUrl,o=void 0===r?"":r,a=e.streamPort,c=void 0===a?80:a,u=e.login,l=void 0===u?"":u,f=e.password,m=void 0===f?"":f,p=e.mode,y=void 0===p?i.Live:p,g=e.muted,b=void 0!==g&&g,w=e.camera,x=e.protocol,T=Vt((0,n.useState)(l),2),E=T[0],L=T[1],k=Vt((0,n.useState)(null!=m?m:""),2),O=k[0],P=k[1],C=Vt((0,n.useState)(y),2),M=C[0],_=C[1],R=Vt((0,n.useState)(!0),2),A=R[0],D=R[1],F=Vt((0,n.useState)(!1),2),I=F[0],B=F[1],G=z(),H=G.serverTime,U=G.setServerTime,V=G.progress,W=G.setProgress,X=Vt((0,n.useState)(!1),2),q=X[0],J=X[1],$=Vt((0,n.useState)(!1),2),K=$[0],Q=$[1],Z=Vt((0,n.useState)(!1),2),ee=Z[0],te=Z[1],re=Vt((0,n.useState)(!1),2),ne=re[0],oe=re[1],ie=Vt((0,n.useState)(!1),2),ae=ie[0],ce=ie[1],ue=Vt((0,n.useState)(!1),2),le=ue[0],se=ue[1],fe=Vt((0,n.useState)(!1),2),de=fe[0],he=fe[1],ve=(0,n.useRef)(null),me=Vt((0,n.useState)(!0),2),pe=me[0],ye=me[1],ge=Vt((0,n.useState)(b),2),be=ge[0],we=ge[1],xe=Vt((0,n.useState)(1),2),Te=xe[0],Ee=xe[1],je=Vt((0,n.useState)(!1),2),Se=je[0],Le=je[1],ke=(0,n.useRef)(null),Oe=(0,n.useRef)(null),Pe=(0,n.useRef)(null),Ce=(0,n.useRef)(null),Me=(0,n.useRef)(null),_e=(0,n.useRef)(!1),Re=null!=x?x:h(),Ne=Vt((0,n.useState)([]),2),Ae=Ne[0],De=Ne[1],Fe=Vt((0,n.useState)(w),2),Ie=Fe[0],Be=Fe[1],ze=void 0===w&&Ae.length>0,Ge="record"===M?"m3u8":"mp4",He="".concat(E,":").concat(O),Ue=(t=Ge,"".concat(Re,"://").concat(o,":").concat(c,"/cameras/").concat(null!=Ie?Ie:0,"/streaming/main.").concat(t,"?authorization=Basic%20").concat(v("".concat(E,":").concat(O)))),Ve=Y(void 0,o,c,de?He:void 0,Re).updateServerTime,We="";de&&void 0!==Ie&&(We="record"===M&&H?"".concat(Ue,"&time=").concat(s(H),"&autoplay=1&audio=1"):Ue||""),(0,n.useEffect)((function(){A&&M!==y&&D(!1)}),[M,y,A]),(0,n.useEffect)((function(){var e=function(){var e=Ut(Gt().mark((function e(){var t;return Gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(o,c,He,null!=Ie?Ie:0,Re);case 2:t=e.sent,Q("h265"===t.result.state.video_streams.video.codec),te("no"===t.result.state.audio_streams.audio.signal);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();de&&o&&c&&He&&Number.isInteger(Ie)&&e()}),[de,o,c,He,Ie,Re]);var Ye=(0,n.useCallback)(function(){var e=Ut(Gt().mark((function e(t){return Gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o&&c){e.next=2;break}return e.abrupt("return");case 2:return oe(!0),he(!1),se(!1),ce(!1),e.prev=6,e.next=9,S(o,c,t,void 0,Re);case 9:ce(!1),se(!1),he(!0),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(6),"FORBIDDEN"===(null===e.t0||void 0===e.t0?void 0:e.t0.message)?(ce(!0),se(!1),he(!1)):(se(!0),he(!1));case 17:return e.prev=17,oe(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[6,14,17,20]])})));return function(t){return e.apply(this,arguments)}}(),[o,c,Re]),Xe=(0,n.useCallback)(function(){var e=Ut(Gt().mark((function e(t){return Gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,Ye("".concat(E,":").concat(O));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[Ye,E,O]);(0,n.useEffect)((function(){Ye("".concat(E,":").concat(O))}),[Ye,o,c,Ie]),(0,n.useEffect)((function(){var e=function(){var e=Ut(Gt().mark((function e(){var t;return Gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(de&&o&&c){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,S(o,c,"".concat(E,":").concat(O),void 0,Re);case 5:t=e.sent,De(t),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();e()}),[de,o,c,E,O,Ie,Re]),(0,n.useEffect)((function(){L(l),P(null!=m?m:"")}),[l,m]),(0,n.useEffect)((function(){o&&c&&Ye("".concat(l,":").concat(null!=m?m:""))}),[o,c,l,m,Ye]);var qe=function(e,t){_(e),t?U(t,!0):Ve()},Je=function(){var e=Ut(Gt().mark((function e(t){var r,n;return Gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve();case 2:n=e.sent,t.getTime()>(null!==(r=null==n?void 0:n.getTime())&&void 0!==r?r:0)?(_(i.Live),W(0)):qe(i.Record,t),ye(!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$e=function(e){ye(null!=e?e:!pe)},Ke=(0,n.useCallback)((function(){ve.current&&clearTimeout(ve.current),Le(!0),ve.current=setTimeout((function(){Le(!1)}),1e4)}),[]),Qe=(0,n.useCallback)((function(){var e;document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen().catch((function(e){console.error("Ошибка при попытке выхода из полноэкранного режима: ".concat(e.message))})):null!==(e=ke.current)&&void 0!==e&&e.requestFullscreen&&ke.current.requestFullscreen().catch((function(e){console.error("Ошибка при попытке перехода в полноэкранный режим: ".concat(e.message))}))}),[]),Ze=(0,n.useCallback)((function(){B((function(e){return!e})),Qe()}),[Qe]);(0,n.useEffect)((function(){var e=function(){var e=Ut(Gt().mark((function e(t){var r,n,o,a,c,u,l,s,f,h,v,m,p,y,g,b,w,x,T,E,j;return Gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null===(r=t.key)||void 0===r?void 0:r.toLowerCase(),a=t.code,c=t.target,!("input"===(u=null==c||null===(n=c.tagName)||void 0===n?void 0:n.toLowerCase())||"textarea"===u||"select"===u||null!=c&&c.isContentEditable)){e.next=6;break}return e.abrupt("return");case 6:if("f"!==o){e.next=10;break}return t.preventDefault(),Ze(),e.abrupt("return");case 10:if(" "!==o&&"Space"!==a&&"Spacebar"!==t.key){e.next=15;break}return t.preventDefault(),ye((function(e){return!e})),e.abrupt("return");case 15:if(s="arrowright"===o||"ArrowRight"===a,!(l="arrowleft"===o||"ArrowLeft"===a)&&!s){e.next=82;break}if(console.log("arrow click"),t.preventDefault(),Ke(),h=l?-5:5,M!==i.Live||!l){e.next=45;break}if(null===(m=Ce.current)||void 0===m){e.next=27;break}e.t1=m,e.next=30;break;case 27:return e.next=29,Ve();case 29:e.t1=e.sent;case 30:if(e.t2=v=e.t1,e.t0=null!==e.t2,!e.t0){e.next=34;break}e.t0=void 0!==v;case 34:if(!e.t0){e.next=38;break}e.t3=v,e.next=39;break;case 38:e.t3=new Date;case 39:return p=e.t3,y=d(p,h),Ce.current=y,_(i.Record),U(y,!0),e.abrupt("return");case 45:if(M!==i.Record||!H){e.next=81;break}if(g=d(H,V+h),!s){e.next=78;break}if(console.log("right arrow click"),w=null!==(b=Me.current)&&void 0!==b?b:V,x=w+5,Me.current=x,g=d(H,x),T=new Date,console.log("approxNow",T),console.log("candidateAbsolute",g),!(g.getTime()>T.getTime())){e.next=77;break}return Me.current=null,e.next=60,Ve();case 60:if(e.t5=E=e.sent,e.t4=null!==e.t5,!e.t4){e.next=64;break}e.t4=void 0!==E;case 64:if(!e.t4){e.next=68;break}e.t6=E,e.next=69;break;case 68:e.t6=new Date;case 69:return j=e.t6,console.log("switch to live",j),_(i.Live),U(j,!1),W(0),e.abrupt("return");case 77:U(g,!0);case 78:if(!(l&&V+h<0)){e.next=81;break}return U(g,!0),e.abrupt("return");case 81:null===(f=Pe.current)||void 0===f||f.seekBy(h);case 82:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[Ze,M,H,V,Ve,W,U,Ke]),(0,n.useEffect)((function(){M!==i.Live&&(Ce.current=null),M!==i.Record&&(Me.current=null)}),[M]),(0,n.useEffect)((function(){Me.current=null}),[V]),(0,n.useEffect)((function(){var e=function(){return B(Boolean(document.fullscreenElement))};return document.addEventListener("fullscreenchange",e),function(){return document.removeEventListener("fullscreenchange",e)}}),[]),(0,n.useEffect)((function(){var e=function(){if("visible"!==document.visibilityState)return _e.current=pe,void(pe&&ye(!1));var e=function(){var e=Ut(Gt().mark((function e(){return Gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M!==i.Live){e.next=4;break}return e.next=3,Ve();case 3:W(0);case 4:_e.current&&ye(!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()};return document.addEventListener("visibilitychange",e),function(){return document.removeEventListener("visibilitychange",e)}}),[pe,M,Ve,W]);var et={url:We,playing:pe,muted:be,playbackSpeed:Te,onPlayPause:function(e){return $e(e)},onProgress:function(e){W(e.currentTime)}};return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("div",{className:"player--JQmgW",ref:ke,role:"region","aria-label":"Плеер видео",children:[(0,N.jsxs)("div",{className:"topControls--lX1gb",children:[(0,N.jsx)(_t,{mode:M,isPlaying:pe}),ze&&(0,N.jsxs)("select",{value:null!=Ie?Ie:"",onChange:function(e){return Be(Number(e.target.value))},"aria-label":"Выбор камеры",children:[(0,N.jsx)("option",{value:"",disabled:!0,children:"Выберите камеру"}),Ae.map((function(e){var t;return(0,N.jsx)("option",{value:e.id,children:null!==(t=e.name)&&void 0!==t?t:"Camera ".concat(e.id)},e.id)}))]})]}),(0,N.jsxs)("div",{className:"videoContainer--fC5VQ",onDoubleClick:Ze,role:"button","aria-label":"Переключить полноэкранный режим",tabIndex:0,onKeyDown:function(e){"enter"===e.key.toLowerCase()&&(e.preventDefault(),Ze())},children:["record"===M?(0,N.jsx)(jt,Bt(Bt({ref:Pe},et),{},{overlayText:K?"265":void 0})):(0,N.jsx)(kt,Bt(Bt({ref:Pe},et),{},{overlayText:K?"265":void 0})),q&&(0,N.jsx)(Mt,{currentTime:d(null!=H?H:new Date,V),isOpen:q,onClose:function(){return J(!1)},onFinish:function(e,t){var r,n,i,a,u,l,f="record_".concat(s(e,"yyyy-MM-dd_HH-mm"),"_").concat(s(t,"yyyy-MM-dd_HH-mm")),d=(t.getTime()-e.getTime())/1e3,h=e.toISOString().split(".")[0],m=function(e){var t=e.url,r=e.start,n=e.end,o=e.fileName,i=Math.floor(r.getTime()/1e3),a=Math.floor(n.getTime()/1e3);return"".concat(t,"&start=").concat(i,"&end=").concat(a,"&filename=").concat(encodeURIComponent(o),".mp4")}({url:"".concat(Re,"://").concat(o,":").concat(c,"/cameras/").concat(null!=Ie?Ie:0,"/streaming/main.mp4?authorization=Basic%20").concat(v("".concat(E,":").concat(O)),"&time=").concat(h,"&duration=").concat((r=d,n=Math.floor(r/3600),i=Math.floor(r%3600/60),a=Math.floor(r%60),"".concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0"))),"&download=1&filename=").concat(f),start:e,end:t,fileName:f});u=m,(l=document.createElement("a")).href=u,l.style.display="none",document.body.appendChild(l),l.click(),setTimeout((function(){document.body.removeChild(l)}),1e3),J(!1)}}),(le||ae)&&(0,N.jsxs)("div",{className:"overlay--UZiSx","aria-live":"polite",children:[le&&(0,N.jsxs)("div",{className:Rt,role:"alert",children:[(0,N.jsx)("div",{className:Nt,children:"Сервер недоступен"}),(0,N.jsx)("div",{className:"overlayText--ru4D4",children:"Проверьте подключение и попробуйте позже."})]}),ae&&(0,N.jsxs)("div",{className:Rt,role:"dialog","aria-modal":"true",children:[(0,N.jsx)("div",{className:Nt,children:"Требуется авторизация"}),(0,N.jsxs)("form",{className:"loginForm--BV06R",onSubmit:Xe,children:[(0,N.jsxs)("label",{className:At,children:["Логин",(0,N.jsx)("input",{className:Dt,type:"text",value:E,onChange:function(e){return L(e.target.value)}})]}),(0,N.jsxs)("label",{className:At,children:["Пароль",(0,N.jsx)("input",{className:Dt,type:"password",value:O,onChange:function(e){return P(e.target.value)}})]}),(0,N.jsx)("div",{className:"actions--js8Rc",children:(0,N.jsx)("button",{type:"submit",className:"primaryButton--JaLCy",disabled:ne,children:"Войти"})})]})]})]})]}),(0,N.jsx)("div",{className:"controlArea--zBPZ2",ref:Oe,onMouseEnter:function(){ve.current&&clearTimeout(ve.current),Le(!0)},onMouseLeave:function(){ve.current=setTimeout((function(){Le(!1)}),1e4)},children:(0,N.jsx)("div",{className:"".concat("controlPanelContainer--En7Nb"," ").concat(Se?"show--KzFdX":""),children:(0,N.jsx)(ht,{mode:M,isPlaying:pe,isMuted:be,isFullscreen:I,isNoSound:ee,playbackSpeed:Te,url:o,port:c,credentials:de?He:"",progress:V,camera:null!=Ie?Ie:0,onPlayPause:function(){return $e()},onMuteToggle:function(){we(!be)},onToggleFullscreen:function(){return Ze()},onSpeedChange:function(e){Ee(e)},onSaveStream:function(){J(!0)},onTimeClick:Je,onChangeStartDate:function(e){U(e),_(i.Record)},onChangeMode:qe,disableSpeedChange:M===i.Live,disableCenterTimeline:M===i.Live})})})]})})};function Xt(e){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xt(e)}function qt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Jt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(r),!0).forEach((function(t){$t(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $t(e,t,r){return(t=Qt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qt(n.key),n)}}function Qt(e){var t=function(e){if("object"!=Xt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Xt(t)?t:t+""}var Zt=function(){return e=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{streamUrl:"",streamPort:80,camera:0,login:"",password:"",mode:i.Live,muted:!0,protocol:a.Http};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t){var n=document.querySelector(t);if(!n)throw new Error("Container element ".concat(t," not found"));this.container=n}else this.container=t;if(!r.streamUrl)throw new Error("streamUrl is required");this.options=r,this.root=(0,o.createRoot)(this.container),this.render()},(t=[{key:"render",value:function(){this.root.render((0,N.jsx)(n.StrictMode,{children:(0,N.jsx)(B,{children:(0,N.jsx)(J,{children:(0,N.jsx)(Yt,Jt({},this.options))})})}))}},{key:"destroy",value:function(){this.root.unmount()}}])&&Kt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const er=Zt;"undefined"!=typeof window&&(window.DevLinePlayer=Zt)}},e=>{e.O(0,[411,61,274,96],(()=>e(e.s=9428)));var t=e.O();return t.default}])));
//# sourceMappingURL=devline-player.aa8c36f9.js.map